
load('../data_for_figs/EV_SH_mat_all.mat')
load('../data_for_figs/EV_LH_mat_all.mat')

EV_SH_mat = [EV_SH_mat_all' EV_LH_mat_all'];

numel_n = 59;

%% Figure
figure('Color','w');
set(gcf,'Unit','centimeters','OuterPosition',[0 0 10 10]);
set(gca,'FontName','Arial','FontSize',10)
hold on

col.all(1,:) = [0.803921580314636 0.878431379795074 0.968627452850342]; 
col.all(2,:) = [0.39215686917305 0.474509805440903 0.635294139385223]; % data points

x_ax = 0:0.4:4;

% SH
b1S= bar(x_ax(3),nanmean(EV_SH_mat_all),'FaceColor',col.all(1,:), 'FaceAlpha', 1, 'BarWidth',1); 

% data points
plot(x_ax(3)*ones(1,size(EV_SH_mat_all,1)), EV_SH_mat_all','.','MarkerEdgeColor',col.all(2,:), 'MarkerSize',3);

% first LH
b1Lf = bar(x_ax(6),nanmean(EV_LH_mat_all),'FaceColor',col.all(1,:), 'FaceAlpha', 1, 'BarWidth',1);

% data points
plot(x_ax(6)*ones(1,size(EV_LH_mat_all,1)), EV_LH_mat_all','.','MarkerEdgeColor',col.all(2,:), 'MarkerSize',3); 

for n = 1:size(EV_LH_mat_all,2)
    lin2 = plot(x_ax([3 6]),[EV_SH_mat_all(n) EV_LH_mat_all(n)]); hold on;
    lin2.Color = [col.all(2,:) 0.3]; % transparency
end

h = errorbar(x_ax([3 6]),...
    [nanmean(EV_SH_mat_all) nanmean(EV_LH_mat_all)], ...
    [nanstd(EV_SH_mat_all)./sqrt(numel_n) nanstd(EV_LH_mat_all)./sqrt(numel_n)],'.','color','k');

set(h,'Marker','none')

xlim([0 2.8])   
set(gca,'XTick',[x_ax(3) x_ax(6)])

labels = {'Short horizon', 'Long horizon'};

a = gca;
a.XTickLabel = labels;

ylabel({'Expected value','of chosen bandit'}','FontName','Arial','Fontweight','bold','FontSize',12);
set(gca,'YTick',0:0.5:10)
ylim([5.2 7.2])

%% Export
addpath('../../export_fig')
export_fig(['Fig_behaviour_EV.tif'],'-nocrop','-r200')
